<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bot Manager Pro | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–æ—Ç–æ–º</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Geologica:wght@100..900&family=Pixelify+Sans:wght@400..700&display=swap" rel="stylesheet">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --primary: #6e45e2;
            --secondary: #88d3ce;
            --accent: #ff7e5f;
            --dark: #1a1a2e;
            --light: #f9f9ff;
            --glow: 0 0 15px rgba(110, 69, 226, 0.5);
            --success: #4caf50;
            --warning: #ff9800;
            --danger: #f44336;
            --telegram-bg: #18222d;
            --telegram-text: #ffffff;
            --telegram-button: #2ea6ff;
            --button-bg: rgba(46, 166, 255, 0.2);
            --button-hover: rgba(46, 166, 255, 0.3);
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            margin: 0;
            padding: 0;
            font-family: 'Geologica', sans-serif;
            background-color: var(--telegram-bg);
            color: var(--telegram-text);
            min-height: 100vh;
            overflow-x: hidden;
            user-select: none;
        }
        
        #app {
            max-width: 100%;
            margin: 0 auto;
            position: relative;
            min-height: 100vh;
            padding: 15px;
            padding-bottom: 70px;
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding: 10px 0;
        }
        
        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(90deg, var(--telegram-button), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            font-family: 'Pixelify Sans', sans-serif;
        }
        
        .balance-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .balance {
            background: rgba(46, 166, 255, 0.2);
            padding: 8px 12px;
            border-radius: 50px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
        }
        
        .mobile-menu {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(24, 34, 45, 0.95);
            backdrop-filter: blur(10px);
            display: flex;
            justify-content: space-around;
            padding: 10px 0;
            z-index: 100;
            border-top: 1px solid rgba(46, 166, 255, 0.1);
        }
        
        .menu-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            color: var(--telegram-text);
            text-decoration: none;
            font-size: 0.7rem;
            opacity: 0.7;
            transition: opacity 0.2s;
            padding: 5px;
        }
        
        .menu-item.active {
            opacity: 1;
            color: var(--telegram-button);
        }
        
        .menu-icon {
            font-size: 1.2rem;
        }
        
        .notification {
            position: fixed;
            top: 15px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            padding: 10px 15px;
            border-radius: 50px;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
            animation: slideIn 0.3s ease-out, fadeOut 0.3s ease-out 2s forwards;
            max-width: 90%;
        }
        
        @keyframes slideIn {
            from {
                top: -50px;
                opacity: 0;
            }
            to {
                top: 15px;
                opacity: 1;
            }
        }
        
        @keyframes fadeOut {
            to {
                opacity: 0;
                visibility: hidden;
            }
        }
        
        .notification-icon {
            font-size: 1rem;
        }
        
        .notification-success {
            border-left: 3px solid var(--success);
        }
        
        .notification-error {
            border-left: 3px solid var(--danger);
        }
        
        .notification-warning {
            border-left: 3px solid var(--warning);
        }
        
        .telegram-button {
            background: var(--telegram-button);
            border: none;
            color: white;
            padding: 10px 15px;
            border-radius: 50px;
            font-family: 'Geologica', sans-serif;
            font-weight: 600;
            margin-top: 15px;
            cursor: pointer;
            transition: opacity 0.2s;
            width: 100%;
            font-size: 0.9rem;
        }
        
        .telegram-button:active {
            opacity: 0.8;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —á–∞—Ç–∞ */
        .chat-container {
            display: flex;
            flex-direction: column;
            height: 60vh;
            overflow-y: auto;
            margin-bottom: 15px;
            border: 1px solid rgba(46, 166, 255, 0.2);
            border-radius: 12px;
            padding: 10px;
            background: rgba(46, 166, 255, 0.05);
        }
        
        .message {
            max-width: 80%;
            margin-bottom: 10px;
            padding: 8px 12px;
            border-radius: 12px;
            word-wrap: break-word;
        }
        
        .user-message {
            align-self: flex-end;
            background: rgba(46, 166, 255, 0.2);
            border-bottom-right-radius: 0;
        }
        
        .bot-message {
            align-self: flex-start;
            background: rgba(255, 255, 255, 0.1);
            border-bottom-left-radius: 0;
        }
        
        .message-time {
            font-size: 0.7rem;
            opacity: 0.6;
            margin-top: 3px;
            text-align: right;
        }
        
        .chat-input {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .chat-input-field {
            flex: 1;
            background: rgba(46, 166, 255, 0.1);
            border: 1px solid rgba(46, 166, 255, 0.2);
            border-radius: 50px;
            padding: 10px 15px;
            color: white;
            font-family: 'Geologica', sans-serif;
        }
        
        .chat-input-field:focus {
            outline: none;
            border-color: var(--telegram-button);
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –≤ —á–∞—Ç–µ */
        .buttons-row {
            display: flex;
            gap: 8px;
            margin-top: 8px;
            flex-wrap: wrap;
        }
        
        .chat-button {
            background: var(--button-bg);
            border: none;
            color: var(--telegram-text);
            padding: 6px 12px;
            border-radius: 8px;
            font-family: 'Geologica', sans-serif;
            font-size: 0.8rem;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .chat-button:hover {
            background: var(--button-hover);
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–æ–º–∞–Ω–¥ */
        .command-item {
            background: rgba(46, 166, 255, 0.1);
            border-radius: 12px;
            padding: 12px;
            margin-bottom: 10px;
            border: 1px solid rgba(46, 166, 255, 0.2);
        }
        
        .command-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .command-name {
            font-weight: 600;
            color: var(--telegram-button);
        }
        
        .command-description {
            font-size: 0.8rem;
            opacity: 0.8;
            margin-bottom: 8px;
        }
        
        .command-response {
            font-size: 0.8rem;
            background: rgba(0, 0, 0, 0.2);
            padding: 8px;
            border-radius: 8px;
            margin-top: 8px;
            white-space: pre-wrap;
        }
        
        .command-actions {
            display: flex;
            gap: 8px;
            margin-top: 10px;
        }
        
        .command-button {
            background: rgba(46, 166, 255, 0.2);
            border: none;
            color: var(--telegram-text);
            padding: 6px 12px;
            border-radius: 50px;
            font-family: 'Geologica', sans-serif;
            font-weight: 600;
            cursor: pointer;
            transition: opacity 0.2s;
            font-size: 0.8rem;
        }
        
        .command-button:active {
            opacity: 0.8;
        }
        
        .command-button.delete {
            background: rgba(244, 67, 54, 0.2);
            color: var(--danger);
        }
        
        .command-button.edit {
            background: rgba(255, 152, 0, 0.2);
            color: var(--warning);
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö */
        .variable-item {
            background: rgba(46, 166, 255, 0.1);
            border-radius: 12px;
            padding: 12px;
            margin-bottom: 10px;
            border: 1px solid rgba(46, 166, 255, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .variable-info {
            flex: 1;
        }
        
        .variable-name {
            font-weight: 600;
            color: var(--accent);
        }
        
        .variable-value {
            font-size: 0.8rem;
            opacity: 0.8;
            margin-top: 3px;
            word-break: break-all;
        }
        
        .variable-type {
            font-size: 0.7rem;
            padding: 2px 6px;
            border-radius: 4px;
            background: rgba(255, 126, 95, 0.2);
            color: var(--accent);
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —Ñ–æ—Ä–º */
        .form-container {
            background: rgba(46, 166, 255, 0.1);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            border: 1px solid rgba(46, 166, 255, 0.2);
        }
        
        .form-group {
            margin-bottom: 12px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 5px;
            font-size: 0.8rem;
            opacity: 0.8;
        }
        
        .form-input {
            width: 100%;
            background: rgba(46, 166, 255, 0.1);
            border: 1px solid rgba(46, 166, 255, 0.2);
            border-radius: 8px;
            padding: 8px 12px;
            color: white;
            font-family: 'Geologica', sans-serif;
        }
        
        .form-input:focus {
            outline: none;
            border-color: var(--telegram-button);
        }
        
        .form-textarea {
            width: 100%;
            height: 100px;
            background: rgba(46, 166, 255, 0.1);
            border: 1px solid rgba(46, 166, 255, 0.2);
            border-radius: 8px;
            padding: 8px 12px;
            color: white;
            font-family: 'Geologica', sans-serif;
            resize: vertical;
        }
        
        .form-textarea:focus {
            outline: none;
            border-color: var(--telegram-button);
        }
        
        .form-select {
            width: 100%;
            background: rgba(46, 166, 255, 0.1);
            border: 1px solid rgba(46, 166, 255, 0.2);
            border-radius: 8px;
            padding: 8px 12px;
            color: white;
            font-family: 'Geologica', sans-serif;
        }
        
        .form-select:focus {
            outline: none;
            border-color: var(--telegram-button);
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —É—Å–ª–æ–≤–∏–π */
        .condition-item {
            background: rgba(46, 166, 255, 0.1);
            border-radius: 12px;
            padding: 12px;
            margin-bottom: 10px;
            border: 1px solid rgba(46, 166, 255, 0.2);
        }
        
        .condition-expression {
            font-family: monospace;
            background: rgba(0, 0, 0, 0.2);
            padding: 6px;
            border-radius: 6px;
            margin: 8px 0;
        }
        
        .condition-actions {
            font-size: 0.8rem;
            background: rgba(76, 175, 80, 0.1);
            padding: 8px;
            border-radius: 6px;
            margin-top: 8px;
            white-space: pre-wrap;
        }
        
        /* –û–±—â–∏–µ —Å—Ç–∏–ª–∏ */
        .section-title {
            font-size: 1.1rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö */
        .db-status {
            background: rgba(46, 166, 255, 0.1);
            border-radius: 12px;
            padding: 12px;
            margin-bottom: 15px;
            border: 1px solid rgba(46, 166, 255, 0.2);
            font-size: 0.9rem;
        }
        
        .db-status span {
            font-weight: 600;
            color: var(--telegram-button);
        }
        
        .backup-controls {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <div id="app">
        <div class="header">
            <div class="logo">BOT MANAGER PRO</div>
            <div class="balance-container">
                <div class="balance">
                    <span>ü§ñ</span>
                    <span>{{ botName }}</span>
                </div>
            </div>
        </div>
        
        <div class="tab-content" :class="{active: activeTab === 'chat'}">
            <h2 class="section-title">üí¨ –ß–∞—Ç —Å –±–æ—Ç–æ–º</h2>
            
            <div class="chat-container" ref="chatContainer">
                <div class="message" :class="message.type" v-for="message in chatMessages" :key="message.id">
                    <div>{{ message.text }}</div>
                    <div v-if="message.buttons && message.buttons.length > 0" class="buttons-row">
                        <button 
                            class="chat-button" 
                            v-for="(button, btnIndex) in message.buttons" 
                            :key="btnIndex"
                            @click="handleButtonClick(button)"
                        >
                            {{ button.text }}
                        </button>
                    </div>
                    <div class="message-time">{{ formatTime(message.time) }}</div>
                </div>
            </div>
            
            <div class="chat-input">
                <input 
                    type="text" 
                    class="chat-input-field" 
                    v-model="newMessage" 
                    placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..."
                    @keyup.enter="sendMessage"
                >
                <button class="telegram-button" @click="sendMessage" style="width: auto; padding: 0 15px;">
                    üì§
                </button>
            </div>
        </div>
        
        <div class="tab-content" :class="{active: activeTab === 'commands'}">
            <h2 class="section-title">üõ†Ô∏è –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞</h2>
            
            <div class="form-container" v-if="showCommandForm">
                <h3 class="section-title">{{ editingCommand ? '‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—É' : '‚ûï –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—É' }}</h3>
                
                <div class="form-group">
                    <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã (–±–µ–∑ /)</label>
                    <input type="text" class="form-input" v-model="currentCommand.name" placeholder="start">
                </div>
                
                <div class="form-group">
                    <label class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã</label>
                    <input type="text" class="form-input" v-model="currentCommand.description" placeholder="–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ">
                </div>
                
                <div class="form-group">
                    <label class="form-label">–û—Ç–≤–µ—Ç –±–æ—Ç–∞</label>
                    <textarea class="form-textarea" v-model="currentCommand.response" placeholder="–ü—Ä–∏–≤–µ—Ç! –Ø –≤–∞—à –±–æ—Ç. –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?"></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">–ö–Ω–æ–ø–∫–∏ (JSON –º–∞—Å—Å–∏–≤)</label>
                    <textarea 
                        class="form-textarea" 
                        v-model="currentCommand.buttons" 
                        placeholder='[{"text": "–ö–Ω–æ–ø–∫–∞ 1", "action": "command1"}, {"text": "–ö–Ω–æ–ø–∫–∞ 2", "action": "command2"}]'
                    ></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">–î–æ—Å—Ç—É–ø–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ: {{ availableVariables.join(', ') }}</label>
                </div>
                
                <button class="telegram-button" @click="saveCommand">
                    {{ editingCommand ? '–û–±–Ω–æ–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—É' : '–î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—É' }}
                </button>
                <button class="telegram-button" @click="cancelCommand" style="background: rgba(244, 67, 54, 0.2); color: var(--danger); margin-top: 10px;">
                    –û—Ç–º–µ–Ω–∞
                </button>
            </div>
            
            <button class="telegram-button" @click="addNewCommand" v-if="!showCommandForm">
                ‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –∫–æ–º–∞–Ω–¥—É
            </button>
            
            <div class="command-item" v-for="(command, index) in botCommands" :key="index">
                <div class="command-header">
                    <div class="command-name">/{{ command.name }}</div>
                    <div class="command-description">{{ command.description }}</div>
                </div>
                <div class="command-response">{{ command.response }}</div>
                <div v-if="command.buttons && command.buttons.length > 0" class="buttons-row">
                    <button class="chat-button" v-for="(button, btnIndex) in command.buttons" :key="btnIndex">
                        {{ button.text }}
                    </button>
                </div>
                <div class="command-actions">
                    <button class="command-button edit" @click="editCommand(index)">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                    <button class="command-button delete" @click="deleteCommand(index)">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
                    <button class="command-button" @click="testCommand(index)">üîÑ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                </div>
            </div>
        </div>
        
        <div class="tab-content" :class="{active: activeTab === 'variables'}">
            <h2 class="section-title">üìä –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –±–æ—Ç–∞</h2>
            
            <div class="form-container" v-if="showVariableForm">
                <h3 class="section-title">{{ editingVariable ? '‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é' : '‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é' }}</h3>
                
                <div class="form-group">
                    <label class="form-label">–ò–º—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π</label>
                    <input type="text" class="form-input" v-model="currentVariable.name" placeholder="welcome_message">
                </div>
                
                <div class="form-group">
                    <label class="form-label">–¢–∏–ø –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π</label>
                    <select class="form-select" v-model="currentVariable.type">
                        <option value="string">–¢–µ–∫—Å—Ç (string)</option>
                        <option value="number">–ß–∏—Å–ª–æ (number)</option>
                        <option value="boolean">–õ–æ–≥–∏—á–µ—Å–∫–æ–µ (boolean)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">–ó–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π</label>
                    <textarea 
                        class="form-textarea" 
                        v-model="currentVariable.value" 
                        :placeholder="currentVariable.type === 'number' ? '0' : currentVariable.type === 'boolean' ? 'true –∏–ª–∏ false' : '–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!'"
                    ></textarea>
                </div>
                
                <button class="telegram-button" @click="saveVariable">
                    {{ editingVariable ? '–û–±–Ω–æ–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é' : '–î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é' }}
                </button>
                <button class="telegram-button" @click="cancelVariable" style="background: rgba(244, 67, 54, 0.2); color: var(--danger); margin-top: 10px;">
                    –û—Ç–º–µ–Ω–∞
                </button>
            </div>
            
            <button class="telegram-button" @click="addNewVariable" v-if="!showVariableForm">
                ‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é
            </button>
            
            <div class="variable-item" v-for="(variable, index) in botVariables" :key="index">
                <div class="variable-info">
                    <div class="variable-name">{{ variable.name }} <span class="variable-type">{{ variable.type }}</span></div>
                    <div class="variable-value">{{ variable.value }}</div>
                </div>
                <div class="command-actions">
                    <button class="command-button edit" @click="editVariable(index)">‚úèÔ∏è</button>
                    <button class="command-button delete" @click="deleteVariable(index)">üóëÔ∏è</button>
                </div>
            </div>
        </div>
        
        <div class="tab-content" :class="{active: activeTab === 'conditions'}">
            <h2 class="section-title">üîÄ –£—Å–ª–æ–≤–∏—è –±–æ—Ç–∞</h2>
            
            <div class="form-container" v-if="showConditionForm">
                <h3 class="section-title">{{ editingCondition ? '‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —É—Å–ª–æ–≤–∏–µ' : '‚ûï –î–æ–±–∞–≤–∏—Ç—å —É—Å–ª–æ–≤–∏–µ' }}</h3>
                
                <div class="form-group">
                    <label class="form-label">–í—ã—Ä–∞–∂–µ–Ω–∏–µ —É—Å–ª–æ–≤–∏—è (JavaScript)</label>
                    <textarea 
                        class="form-textarea" 
                        v-model="currentCondition.expression" 
                        placeholder="user.balance > 100"
                    ></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">–î–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ true (–≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è, –µ—Å–ª–∏ —É—Å–ª–æ–≤–∏–µ –∏—Å—Ç–∏–Ω–Ω–æ)</label>
                    <textarea 
                        class="form-textarea" 
                        v-model="currentCondition.trueActions" 
                        placeholder="user.balance -= 100; bot.sendMessage('–°–ø–∞—Å–∏–±–æ –∑–∞ –ø–æ–∫—É–ø–∫—É!');"
                    ></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">–î–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ false (–≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è, –µ—Å–ª–∏ —É—Å–ª–æ–≤–∏–µ –ª–æ–∂–Ω–æ)</label>
                    <textarea 
                        class="form-textarea" 
                        v-model="currentCondition.falseActions" 
                        placeholder="bot.sendMessage('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤!');"
                    ></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">–î–æ—Å—Ç—É–ø–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ: user (–æ–±—ä–µ–∫—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è), bot (–º–µ—Ç–æ–¥—ã –±–æ—Ç–∞)</label>
                </div>
                
                <button class="telegram-button" @click="saveCondition">
                    {{ editingCondition ? '–û–±–Ω–æ–≤–∏—Ç—å —É—Å–ª–æ–≤–∏–µ' : '–î–æ–±–∞–≤–∏—Ç—å —É—Å–ª–æ–≤–∏–µ' }}
                </button>
                <button class="telegram-button" @click="cancelCondition" style="background: rgba(244, 67, 54, 0.2); color: var(--danger); margin-top: 10px;">
                    –û—Ç–º–µ–Ω–∞
                </button>
            </div>
            
            <button class="telegram-button" @click="addNewCondition" v-if="!showConditionForm">
                ‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ —É—Å–ª–æ–≤–∏–µ
            </button>
            
            <div class="condition-item" v-for="(condition, index) in botConditions" :key="index">
                <div class="command-header">
                    <div class="command-name">–£—Å–ª–æ–≤–∏–µ #{{ index + 1 }}</div>
                </div>
                <div class="condition-expression">if ({{ condition.expression }})</div>
                <div class="condition-actions">
                    <strong>True:</strong> {{ condition.trueActions || '–Ω–µ—Ç –¥–µ–π—Å—Ç–≤–∏–π' }}
                </div>
                <div class="condition-actions">
                    <strong>False:</strong> {{ condition.falseActions || '–Ω–µ—Ç –¥–µ–π—Å—Ç–≤–∏–π' }}
                </div>
                <div class="command-actions">
                    <button class="command-button edit" @click="editCondition(index)">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                    <button class="command-button delete" @click="deleteCondition(index)">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
                    <button class="command-button" @click="testCondition(index)">üîÑ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                </div>
            </div>
        </div>
        
        <div class="tab-content" :class="{active: activeTab === 'database'}">
            <h2 class="section-title">üíæ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö</h2>
            
            <div class="db-status">
                <div><span>–°—Ç–∞—Ç—É—Å:</span> {{ dbStatus }}</div>
                <div><span>–†–∞–∑–º–µ—Ä:</span> {{ dbSize }} KB</div>
                <div><span>–ü–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ:</span> {{ lastSaveTime }}</div>
            </div>
            
            <div class="form-container">
                <h3 class="section-title">üîÅ –ò–º–ø–æ—Ä—Ç/–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</h3>
                
                <div class="form-group">
                    <label class="form-label">–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –≤ JSON</label>
                    <button class="telegram-button" @click="exportData">
                        üì§ –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
                    </button>
                </div>
                
                <div class="form-group">
                    <label class="form-label">–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ JSON</label>
                    <textarea 
                        class="form-textarea" 
                        v-model="importDataJson" 
                        placeholder="–í—Å—Ç–∞–≤—å—Ç–µ JSON –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞..."
                    ></textarea>
                    <button class="telegram-button" @click="importData" style="margin-top: 10px;">
                        üì• –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
                    </button>
                </div>
            </div>
            
            <div class="form-container">
                <h3 class="section-title">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö</h3>
                
                <div class="form-group">
                    <label class="form-label">–ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ</label>
                    <select class="form-select" v-model="autoSaveInterval">
                        <option value="5000">5 —Å–µ–∫—É–Ω–¥</option>
                        <option value="15000">15 —Å–µ–∫—É–Ω–¥</option>
                        <option value="30000">30 —Å–µ–∫—É–Ω–¥</option>
                        <option value="60000">1 –º–∏–Ω—É—Ç–∞</option>
                        <option value="300000">5 –º–∏–Ω—É—Ç</option>
                    </select>
                </div>
                
                <button class="telegram-button" @click="forceSave" style="margin-top: 10px;">
                    üíæ –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
                </button>
            </div>
        </div>
        
        <div class="mobile-menu">
            <div class="menu-item" :class="{active: activeTab === 'chat'}" @click="activeTab = 'chat'">
                <div class="menu-icon">üí¨</div>
                <div>–ß–∞—Ç</div>
            </div>
            <div class="menu-item" :class="{active: activeTab === 'commands'}" @click="activeTab = 'commands'">
                <div class="menu-icon">üõ†Ô∏è</div>
                <div>–ö–æ–º–∞–Ω–¥—ã</div>
            </div>
            <div class="menu-item" :class="{active: activeTab === 'variables'}" @click="activeTab = 'variables'">
                <div class="menu-icon">üìä</div>
                <div>–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ</div>
            </div>
            <div class="menu-item" :class="{active: activeTab === 'conditions'}" @click="activeTab = 'conditions'">
                <div class="menu-icon">üîÄ</div>
                <div>–£—Å–ª–æ–≤–∏—è</div>
            </div>
            <div class="menu-item" :class="{active: activeTab === 'database'}" @click="activeTab = 'database'">
                <div class="menu-icon">üíæ</div>
                <div>–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö</div>
            </div>
        </div>
        
        <div class="notification" v-if="notification.show" :class="'notification-' + notification.type">
            <div class="notification-icon">{{ notification.emoji }}</div>
            <div>{{ notification.text }}</div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/vue@3.2.47/dist/vue.global.min.js"></script>
    <script>
    const { createApp, ref, computed, onMounted, nextTick, watch } = Vue;
    
    createApp({
        setup() {
            // Telegram WebApp integration
            const tg = window.Telegram?.WebApp || {};
            const userId = ref(tg.initDataUnsafe?.user?.id || Math.floor(Math.random() * 1000000));
            const userFirstName = ref(tg.initDataUnsafe?.user?.first_name || '–ê–¥–º–∏–Ω');
            const botName = ref("–ú–æ–π –ë–æ—Ç");
            
            // App state
            const activeTab = ref('chat');
            const notification = ref({
                show: false,
                text: '',
                type: 'success',
                emoji: '‚úÖ'
            });
            
            // Chat
            const chatMessages = ref([
                { 
                    id: 1,
                    text: "–ü—Ä–∏–≤–µ—Ç! –Ø –≤–∞—à –±–æ—Ç. –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?", 
                    type: "bot-message", 
                    time: new Date(),
                    buttons: [
                        { text: "–ü–æ–º–æ—â—å", action: "/help" },
                        { text: "–ë–∞–ª–∞–Ω—Å", action: "/balance" }
                    ]
                }
            ]);
            const newMessage = ref("");
            const chatContainer = ref(null);
            
            // Commands
            const botCommands = ref([
                { 
                    name: "start", 
                    description: "–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ", 
                    response: "–ü—Ä–∏–≤–µ—Ç! –Ø –≤–∞—à –±–æ—Ç. –ù–∞–ø–∏—à–∏—Ç–µ /help –¥–ª—è —Å–ø–∏—Å–∫–∞ –∫–æ–º–∞–Ω–¥",
                    buttons: [
                        { text: "–ü–æ–º–æ—â—å", action: "/help" },
                        { text: "–ë–∞–ª–∞–Ω—Å", action: "/balance" }
                    ]
                },
                { 
                    name: "help", 
                    description: "–°–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥", 
                    response: "–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:\n/start - –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ\n/help - —ç—Ç–∞ —Å–ø—Ä–∞–≤–∫–∞\n/balance - –ø–æ–∫–∞–∑–∞—Ç—å –±–∞–ª–∞–Ω—Å" 
                },
                { 
                    name: "balance", 
                    description: "–ü–æ–∫–∞–∑–∞—Ç—å –±–∞–ª–∞–Ω—Å", 
                    response: "–í–∞—à –±–∞–ª–∞–Ω—Å: {{user_balance}} –±–∞–ª–ª–æ–≤",
                    buttons: [
                        { text: "–ü–æ–ø–æ–ª–Ω–∏—Ç—å +10", action: "/add_balance 10" },
                        { text: "–ü–æ—Ç—Ä–∞—Ç–∏—Ç—å -5", action: "/subtract_balance 5" }
                    ]
                }
            ]);
            const showCommandForm = ref(false);
            const editingCommand = ref(false);
            const currentCommand = ref({
                name: "",
                description: "",
                response: "",
                buttons: "[]"
            });
            
            // Variables
            const botVariables = ref([
                { name: "welcome_message", value: "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –Ω–∞—à –±–æ—Ç!", type: "string" },
                { name: "admin_contact", value: "@support", type: "string" },
                { name: "user_balance", value: "100", type: "number" }
            ]);
            const showVariableForm = ref(false);
            const editingVariable = ref(false);
            const currentVariable = ref({
                name: "",
                value: "",
                type: "string"
            });
            
            // Conditions
            const botConditions = ref([]);
            const showConditionForm = ref(false);
            const editingCondition = ref(false);
            const currentCondition = ref({
                expression: "",
                trueActions: "",
                falseActions: ""
            });
            
            // Database
            const dbStatus = ref("–ê–∫—Ç–∏–≤–Ω–∞");
            const dbSize = ref(0);
            const lastSaveTime = ref("–Ω–∏–∫–æ–≥–¥–∞");
            const autoSaveInterval = ref(30000);
            const importDataJson = ref("");
            let saveInterval = null;
            
            // Computed properties
            const availableVariables = computed(() => {
                return botVariables.value.map(v => `{{${v.name}}}`);
            });
            
            // Methods
            const sendMessage = () => {
                if (!newMessage.value.trim()) return;
                
                // Add user message
                const userMsg = {
                    id: Date.now(),
                    text: newMessage.value,
                    type: "user-message",
                    time: new Date()
                };
                chatMessages.value.push(userMsg);
                
                // Process message
                processMessage(newMessage.value);
                
                newMessage.value = "";
                scrollChatToBottom();
                saveBotData();
            };
            
            const processMessage = (message) => {
                // Check if message is a command
                if (message.startsWith("/")) {
                    const cmdParts = message.slice(1).split(" ");
                    const cmd = cmdParts[0];
                    const args = cmdParts.slice(1);
                    
                    const foundCmd = botCommands.value.find(c => c.name === cmd);
                    
                    if (foundCmd) {
                        // Process command
                        processCommand(foundCmd, args);
                    } else {
                        // Command not found
                        setTimeout(() => {
                            addBotMessage(`–ö–æ–º–∞–Ω–¥–∞ "/${cmd}" –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. –ù–∞–ø–∏—à–∏—Ç–µ /help –¥–ª—è —Å–ø–∏—Å–∫–∞ –∫–æ–º–∞–Ω–¥.`);
                        }, 500);
                    }
                } else {
                    // Default response for non-command messages
                    setTimeout(() => {
                        addBotMessage("–Ø –ø—Ä–æ—Å—Ç–æ–π –±–æ—Ç. –î–ª—è —Ä–∞–±–æ—Ç—ã –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—ã. –ù–∞–ø–∏—à–∏—Ç–µ /help –¥–ª—è —Å–ø–∏—Å–∫–∞ –∫–æ–º–∞–Ω–¥.");
                    }, 500);
                }
            };
            
            const processCommand = (command, args = []) => {
                // Process variables in response
                let response = command.response;
                let buttons = [];
                
                try {
                    buttons = JSON.parse(command.buttons || "[]");
                } catch (e) {
                    console.error("Error parsing buttons:", e);
                }
                
                botVariables.value.forEach(v => {
                    const regex = new RegExp(`\\{\\{${v.name}\\}\\}`, 'g');
                    response = response.replace(regex, v.value);
                });
                
                // Replace args placeholders
                args.forEach((arg, index) => {
                    const regex = new RegExp(`\\{\\{args\\[${index}\\]\\}\\}`, 'g');
                    response = response.replace(regex, arg);
                });
                
                setTimeout(() => {
                    addBotMessage(response, buttons);
                }, 500);
            };
            
            const addBotMessage = (text, buttons = []) => {
                chatMessages.value.push({
                    id: Date.now(),
                    text,
                    type: "bot-message",
                    time: new Date(),
                    buttons
                });
                scrollChatToBottom();
            };
            
            const handleButtonClick = (button) => {
                // Add button click as user message
                chatMessages.value.push({
                    id: Date.now(),
                    text: button.action,
                    type: "user-message",
                    time: new Date()
                });
                
                // Process button action
                if (button.action.startsWith("/")) {
                    processMessage(button.action);
                } else {
                    // Custom action
                    setTimeout(() => {
                        addBotMessage(`–í—ã –Ω–∞–∂–∞–ª–∏ –∫–Ω–æ–ø–∫—É "${button.text}" (–¥–µ–π—Å—Ç–≤–∏–µ: ${button.action})`);
                    }, 500);
                }
                
                scrollChatToBottom();
            };
            
            const scrollChatToBottom = () => {
                nextTick(() => {
                    if (chatContainer.value) {
                        chatContainer.value.scrollTop = chatContainer.value.scrollHeight;
                    }
                });
            };
            
            const formatTime = (date) => {
                return date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            };
            
            // Command methods
            const addNewCommand = () => {
                currentCommand.value = { 
                    name: "", 
                    description: "", 
                    response: "",
                    buttons: "[]"
                };
                showCommandForm.value = true;
                editingCommand.value = false;
            };
            
            const editCommand = (index) => {
                const cmd = botCommands.value[index];
                currentCommand.value = { 
                    ...cmd,
                    buttons: JSON.stringify(cmd.buttons || [], null, 2)
                };
                showCommandForm.value = true;
                editingCommand.value = true;
                currentCommand.editIndex = index;
            };
            
            const saveCommand = () => {
                if (!currentCommand.value.name.trim()) {
                    showNotification("–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã", "error", "‚ùå");
                    return;
                }
                
                if (!currentCommand.value.response.trim()) {
                    showNotification("–í–≤–µ–¥–∏—Ç–µ –æ—Ç–≤–µ—Ç –±–æ—Ç–∞", "error", "‚ùå");
                    return;
                }
                
                // Validate buttons JSON
                let buttons = [];
                try {
                    buttons = JSON.parse(currentCommand.value.buttons || "[]");
                    if (!Array.isArray(buttons)) {
                        throw new Error("Buttons should be an array");
                    }
                } catch (e) {
                    showNotification("–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∫–Ω–æ–ø–æ–∫ (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å JSON –º–∞—Å—Å–∏–≤)", "error", "‚ùå");
                    return;
                }
                
                const commandData = {
                    name: currentCommand.value.name,
                    description: currentCommand.value.description,
                    response: currentCommand.value.response,
                    buttons
                };
                
                if (editingCommand.value) {
                    botCommands.value[currentCommand.editIndex] = commandData;
                    showNotification("–ö–æ–º–∞–Ω–¥–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞", "success", "‚úÖ");
                } else {
                    // Check if command already exists
                    const exists = botCommands.value.some(c => c.name === commandData.name);
                    if (exists) {
                        showNotification("–ö–æ–º–∞–Ω–¥–∞ —Å —Ç–∞–∫–∏–º –∏–º–µ–Ω–µ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç", "error", "‚ùå");
                        return;
                    }
                    
                    botCommands.value.push(commandData);
                    showNotification("–ö–æ–º–∞–Ω–¥–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞", "success", "‚úÖ");
                }
                
                cancelCommand();
                saveBotData();
            };
            
            const cancelCommand = () => {
                showCommandForm.value = false;
                editingCommand.value = false;
                currentCommand.value = { 
                    name: "", 
                    description: "", 
                    response: "",
                    buttons: "[]"
                };
            };
            
            const deleteCommand = (index) => {
                if (confirm("–£–¥–∞–ª–∏—Ç—å —ç—Ç—É –∫–æ–º–∞–Ω–¥—É?")) {
                    botCommands.value.splice(index, 1);
                    showNotification("–ö–æ–º–∞–Ω–¥–∞ —É–¥–∞–ª–µ–Ω–∞", "success", "‚úÖ");
                    saveBotData();
                }
            };
            
            const testCommand = (index) => {
                const cmd = botCommands.value[index];
                chatMessages.value.push({
                    id: Date.now(),
                    text: `/${cmd.name}`,
                    type: "user-message",
                    time: new Date()
                });
                
                processCommand(cmd);
                scrollChatToBottom();
            };
            
            // Variable methods
            const addNewVariable = () => {
                currentVariable.value = { 
                    name: "", 
                    value: "",
                    type: "string"
                };
                showVariableForm.value = true;
                editingVariable.value = false;
            };
            
            const editVariable = (index) => {
                currentVariable.value = { ...botVariables.value[index] };
                showVariableForm.value = true;
                editingVariable.value = true;
                currentVariable.editIndex = index;
            };
            
            const saveVariable = () => {
                if (!currentVariable.value.name.trim()) {
                    showNotification("–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π", "error", "‚ùå");
                    return;
                }
                
                // Validate value based on type
                let validatedValue = currentVariable.value.value;
                
                if (currentVariable.value.type === "number") {
                    if (isNaN(parseFloat(validatedValue))) {
                        showNotification("–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —á–∏—Å–ª–æ", "error", "‚ùå");
                        return;
                    }
                    validatedValue = parseFloat(validatedValue).toString();
                } else if (currentVariable.value.type === "boolean") {
                    if (validatedValue !== "true" && validatedValue !== "false") {
                        showNotification("–í–≤–µ–¥–∏—Ç–µ 'true' –∏–ª–∏ 'false'", "error", "‚ùå");
                        return;
                    }
                }
                
                const variableData = {
                    name: currentVariable.value.name,
                    value: validatedValue,
                    type: currentVariable.value.type
                };
                
                if (editingVariable.value) {
                    botVariables.value[currentVariable.editIndex] = variableData;
                    showNotification("–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞", "success", "‚úÖ");
                } else {
                    // Check if variable already exists
                    const exists = botVariables.value.some(v => v.name === variableData.name);
                    if (exists) {
                        showNotification("–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è —Å —Ç–∞–∫–∏–º –∏–º–µ–Ω–µ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç", "error", "‚ùå");
                        return;
                    }
                    
                    botVariables.value.push(variableData);
                    showNotification("–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–æ–±–∞–≤–ª–µ–Ω–∞", "success", "‚úÖ");
                }
                
                cancelVariable();
                saveBotData();
            };
            
            const cancelVariable = () => {
                showVariableForm.value = false;
                editingVariable.value = false;
                currentVariable.value = { 
                    name: "", 
                    value: "",
                    type: "string"
                };
            };
            
            const deleteVariable = (index) => {
                if (confirm("–£–¥–∞–ª–∏—Ç—å —ç—Ç—É –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é?")) {
                    botVariables.value.splice(index, 1);
                    showNotification("–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è —É–¥–∞–ª–µ–Ω–∞", "success", "‚úÖ");
                    saveBotData();
                }
            };
            
            // Database methods
            const saveBotData = () => {
                const botData = {
                    version: 1,
                    commands: botCommands.value,
                    variables: botVariables.value,
                    conditions: botConditions.value,
                    messages: chatMessages.value,
                    settings: {
                        autoSaveInterval: autoSaveInterval.value
                    }
                };
                
                const dataStr = JSON.stringify(botData);
                localStorage.setItem('botManagerData', dataStr);
                
                // Update db info
                dbSize.value = (dataStr.length / 1024).toFixed(2);
                lastSaveTime.value = new Date().toLocaleString();
                
                return true;
            };
            
            const loadBotData = () => {
                const savedData = localStorage.getItem('botManagerData');
                if (savedData) {
                    try {
                        const parsed = JSON.parse(savedData);
                        
                        botCommands.value = parsed.commands || botCommands.value;
                        botVariables.value = parsed.variables || botVariables.value;
                        botConditions.value = parsed.conditions || botConditions.value;
                        chatMessages.value = parsed.messages || chatMessages.value;
                        
                        if (parsed.settings) {
                            autoSaveInterval.value = parsed.settings.autoSaveInterval || autoSaveInterval.value;
                        }
                        
                        // Update db info
                        dbSize.value = (savedData.length / 1024).toFixed(2);
                        lastSaveTime.value = "—Ç–æ–ª—å–∫–æ —á—Ç–æ";
                        
                        return true;
                    } catch (e) {
                        console.error("Error loading bot data:", e);
                        return false;
                    }
                }
                return false;
            };
            
            const exportData = () => {
                const botData = {
                    commands: botCommands.value,
                    variables: botVariables.value,
                    conditions: botConditions.value
                };
                
                const dataStr = JSON.stringify(botData, null, 2);
                const blob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = `bot_manager_export_${new Date().toISOString().slice(0, 10)}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                showNotification("–î–∞–Ω–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã", "success", "‚úÖ");
            };
            
            const importData = () => {
                if (!importDataJson.value.trim()) {
                    showNotification("–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞", "error", "‚ùå");
                    return;
                }
                
                try {
                    const data = JSON.parse(importDataJson.value);
                    
                    if (confirm("–ó–∞–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–µ –∫–æ–º–∞–Ω–¥—ã, –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ —É—Å–ª–æ–≤–∏—è –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏?")) {
                        if (data.commands) botCommands.value = data.commands;
                        if (data.variables) botVariables.value = data.variables;
                        if (data.conditions) botConditions.value = data.conditions;
                        
                        saveBotData();
                        showNotification("–î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã", "success", "‚úÖ");
                        importDataJson.value = "";
                    }
                } catch (e) {
                    showNotification("–û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞: " + e.message, "error", "‚ùå");
                }
            };
            
            const forceSave = () => {
                if (saveBotData()) {
                    showNotification("–î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã", "success", "‚úÖ");
                } else {
                    showNotification("–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö", "error", "‚ùå");
                }
            };
            
            const setupAutoSave = () => {
                if (saveInterval) {
                    clearInterval(saveInterval);
                }
                
                saveInterval = setInterval(() => {
                    saveBotData();
                }, parseInt(autoSaveInterval.value));
            };
            
            // Notification
            const showNotification = (text, type, emoji) => {
                notification.value = {
                    show: true,
                    text,
                    type,
                    emoji
                };
                
                setTimeout(() => {
                    notification.value.show = false;
                }, 2000);
            };
            
            // Initialize
            onMounted(() => {
                loadBotData();
                scrollChatToBottom();
                setupAutoSave();
                
                // Calculate initial db size
                const savedData = localStorage.getItem('botManagerData');
                if (savedData) {
                    dbSize.value = (savedData.length / 1024).toFixed(2);
                }
                
                // Expand Telegram WebApp if available
                if (tg.expand) {
                    tg.expand();
                }
            });
            
            // Watch for autoSaveInterval changes
            watch(autoSaveInterval, () => {
                setupAutoSave();
                saveBotData();
            });
            
            return {
                botName,
                activeTab,
                notification,
                chatMessages,
                newMessage,
                chatContainer,
                botCommands,
                showCommandForm,
                editingCommand,
                currentCommand,
                botVariables,
                showVariableForm,
                editingVariable,
                currentVariable,
                botConditions,
                showConditionForm,
                editingCondition,
                currentCondition,
                availableVariables,
                dbStatus,
                dbSize,
                lastSaveTime,
                autoSaveInterval,
                importDataJson,
                sendMessage,
                handleButtonClick,
                formatTime,
                addNewCommand,
                editCommand,
                saveCommand,
                cancelCommand,
                deleteCommand,
                testCommand,
                addNewVariable,
                editVariable,
                saveVariable,
                cancelVariable,
                deleteVariable,
                exportData,
                importData,
                forceSave
            };
        }
    }).mount('#app');
</script>
</body>
</html>
